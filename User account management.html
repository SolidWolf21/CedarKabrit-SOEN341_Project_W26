<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Account Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6f8;
            padding: 20px;
        }
         .container {
            max-width: 600px;
            background: #ffffff;
            padding: 20px;
            margin: auto;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h2 {
            border-bottom: 2px solid #eee;
            padding-bottom: 5px;
            margin-top: 20px;
        }
        label {
            display:block;
            margin-top: 10px;
            font-weight: bold;
        }
        input, select , textarea, button {
            width: 100%;
            padding: 8px;
            margin-top: 5px;

        }
    </style>
</head>
<body>

<div class="container">

    <!-- User Registration -->
    <h2>User Registration</h2>
    <form id="registerForm">
        <label for="reg-name">Full Name</label>
        <input type="text" id="reg-name" name="name" required>

        <label for="reg-email">Email</label>
        <input type="email" id="reg-email" name="email" required>

        <label for="reg-password">Password</label>
        <input type="password" id="reg-password" name="password" required>

        <button type="submit">Register</button>

    </form>

    <!-- User Login -->
    <h2>User Login</h2>
    <form id="loginForm">
        <label for="login-email">Email</label>
        <input type="email" id="login-email" name="email" required>

        <label for="login-password">Password</label>
        <input type="password" id="login-password" name="password" required>

        <button type="submit">Login</button>
    </form>

    <!-- Profile Management -->
    <div id="profileSection" class="hidden">
        <form id="profileForm">
            <label for="diet">Diet Prefrence</label>
            <select id="diet" name="diet">
                <option value="">Select</option>
                <option value="vegetarian">Vegetarian</option>
                <option value="vegan">Vegan</option>
                <option value="pescatarian">Pescatarian</option>
                <option value="keto">Keto</option>
                <option value="omnivore">Omnivore</option>
            </select>

            <label for="allergies">Allergies</label>
            <textarea id="allergies" name="allergies" rows="3"
                      placeholder="e.g. peanuts, dairy, shellfish"></textarea>

            <button type="submit">Save Profile</button>
        </form>

    </div>

</div>

<style>
    .hidden { display: none; }
</style>

<script>
    let currentUserEmail = null;

    // Registration
    document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const name = document.getElementById('reg-name').value.trim();
        const email = document.getElementById('reg-email').value.trim().toLowerCase();
        const password = document.getElementById('reg-password').value;

        const users = JSON.parse(localStorage.getItem('users') || '{}');

        if (users[email]) {
            alert('User already exists!');
            return;
        }

        users[email] = { name, email, password, profile: {} };
        localStorage.setItem('users', JSON.stringify(users));
        alert('Registration successful!');
        this.reset();
    });

    // Login
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('login-email').value.trim().toLowerCase();
        const password = document.getElementById('login-password').value;
        const users = JSON.parse(localStorage.getItem('users') || '{}');

        if (!users[email]) {
            alert('Invalid email!');
            return;
        }
        if (users[email].password !== password) {
            alert('Incorrect password!');
            return;
        }

        currentUserEmail = email;
        const currentUser = users[email];
        document.getElementById('profileSection').classList.remove('hidden');

        document.getElementById('diet').value = (currentUser.profile && currentUser.profile.diet) || '';
        document.getElementById('allergies').value = (currentUser.profile && currentUser.profile.allergies) || '';

        alert('Login successful!');
        this.reset();
    });

    // Profile Management and save profile
    document.getElementById('profileForm').addEventListener('submit', function(e) {
        e.preventDefault();
        if (!currentUserEmail) {
            alert('Please log in first!');
            return;
        }

        const users = JSON.parse(localStorage.getItem('users') || '{}');
        const diet = document.getElementById('diet').value;
        const allergies = document.getElementById('allergies').value;

        users[currentUserEmail].profile = users[currentUserEmail].profile || {};
        users[currentUserEmail].profile.diet = diet;
        users[currentUserEmail].profile.allergies = allergies;

        localStorage.setItem('users', JSON.stringify(users));
        alert('Profile updated successfully!');
    });
</script>
</body>
</html>